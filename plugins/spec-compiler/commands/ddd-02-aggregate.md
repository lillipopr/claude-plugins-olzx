---
description: 调用聚合设计Skill，根据限界上下文设计文档生成聚合设计文档。支持两阶段工作流：先生成大纲版讨论优化，定稿后生成详细版。
calls-skill: spec-compiler:ddd-02-aggregate-skill
---

# /ddd-02-aggregate - 聚合设计命令

此命令调用 **ddd-02-aggregate-skill** Skill，从限界上下文设计文档生成聚合设计文档。

## 使用场景

- 已有限界上下文设计文档，需要生成聚合设计
- 需要识别聚合根、实体、值对象
- 需要设计聚合边界和引用关系
- 需要划分领域服务


## 工作流程

```
1. 收集参数
   1.1 限界上下文设计文档路径：ddd-01-bc.md 文件的完整路径
   1.2 输出目录（默认为 ./output）
2. 加载 Skill: spec-compiler:ddd-02-aggregate-skill
3. 执行工作流
   3.1 阶段 1：限界上下文文档分析与大纲生成
        3.1.1 读取限界上下文设计文档（ddd-01-bc.md）
        3.1.2 分析子域划分、上下文映射、外部集成
        3.1.3 识别聚合根、实体、值对象
        3.1.4 生成大纲文件（ddd-02-aggregate-outline.md）
        3.1.5 显示大纲内容，提示用户编辑讨论
   3.2 阶段 2：讨论与优化
        3.2.1 等待用户编辑大纲文件
        3.2.2 用户编辑完成后输入 "继续"
        3.2.3 基于编辑后的大纲生成详细文档
   3.3 阶段 3：详细文档生成
        3.3.1 基于定稿大纲生成详细文档
        3.3.2 输出文件：ddd-02-aggregate.md
```

## 输出文件

| 文件                               | 说明 |
| ---------------------------------- | ---- |
| `ddd-02-aggregate-outline.md`      | 大纲版（可编辑讨论） |
| `ddd-02-aggregate.md` | 详细版（定稿后生成） |

## 核心特性

- **两阶段工作流**：先生成大纲快速评审，定稿后生成详细文档
- **可编辑讨论**：大纲文件可编辑，支持迭代优化
- **质量可控**：通过人工评审确保聚合划分、边界设计的准确性

## 示例

```
用户: /ddd-02-aggregate

Claude: 请提供限界上下文设计文档路径：

用户: ./docs/08-functions/03-user-wallet/02-ddd-01-bc.md

Claude: 请提供输出目录（直接回车使用默认 ./output）：

用户: ./docs/08-functions/03-user-wallet/output

==================================================
聚合设计大纲已生成
==================================================
文件：./docs/08-functions/03-user-wallet/output/ddd-02-aggregate-outline.md

【下一步】
1. 请编辑大纲文件，调整聚合划分、实体识别等
2. 编辑完成后，输入 "继续" 生成详细文档
3. 或输入 "修改 {具体意见}" 进行调整
==================================================

[用户编辑大纲文件...]

用户: 继续

==================================================
聚合设计文档生成完成
==================================================
大纲：ddd-02-aggregate-outline.md
详细：ddd-02-aggregate.md

【检查清单】
- [ ] 聚合根识别是否合理？
- [ ] 实体和值对象划分是否正确？
- [ ] 聚合边界是否清晰？
- [ ] 引用关系设计是否合适？
- [ ] 领域服务识别是否完整？
==================================================

```

## 技术说明

**Command 类型**：直接调用 Skill（非 Agent）

**Skill 路径**：`{CLAUDE_PLUGIN_ROOT}/skills/ddd-02-aggregate-design/SKILL.md`

**优势**：
- 更轻量：无需启动独立 Agent 进程
- 更快速：直接在当前会话中执行
- 更可控：Skill 包含完整流程指引，便于调试和优化
